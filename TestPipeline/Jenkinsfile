pipeline {
    agent any
	tools
	{
		maven 'LocalMaven'
	}
    stages
	{
        stage('Build')
		{
            steps 
			{
				sh 'mvn clean package'
            }
            post 
			{
                success 
				{
                    echo 'Start saving...'
                    archiveArtifacts artifacts: '**/target/*.war'
                }
            }
        }
        stage('deploy to staging')
		{
            steps 
			{
				build job: 'deploytostaging'
            }
        }
        stage('deploy to production')
		{
            steps 
			{
                timeout(time:5, unit:'days')
				{
					input message:'confirm to deploy'
				}
				build job: 'deploytostaging'
            }
			post
			{
				success
				{
					echo 'success'
				}
				failure
				{
					echo 'failure'
				}
			}
        }
    }
}
	
def cmd_exec(command) 
{
	if (isUnix()) 
	{ 
		sh "${command}" 
	} 
	else 
	{ 
		bat "chcp 65001\n${command}"
	}
}